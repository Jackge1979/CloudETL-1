webpackJsonp([73],{396:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(9),r=s(n),u=a(176),o=s(u),l=a(29),c=s(l),i=a(14),p=a(85),d=a(55),f=a(77),g=a(114);new g.Cookies;t.default={namespace:"loginModel",state:{loginStatus:i.LOGIN_SUSPEND,message:"",loginText:"\u767b\u5f55"},effects:{login:c.default.mark(function e(t,a){var s,n,r,u,o,l,g,m,x,y,v,S,I,L,h=t.payload,w=a.put;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({type:"save",payload:{loginText:"\u767b\u5f55\u4e2d..."}});case 2:return e.next=4,(0,p.submitLogin)(h);case 4:return s=e.sent,n=s.data,e.next=8,w({type:"getCaptcha"});case 8:if(r=n.message,!n||200!==n.status){e.next=20;break}return u=n.loginUser,o=n.sysList,l=n.vt,g=u.username,m=u.renterId,x=u.deptId,y=u.realName,v=u.id,S=u.pswd,I=u.email,L=u.phone,h.rememberMe?(0,d.saveLocalUser)({userName:h.name,password:h.passwd}):(0,d.saveLocalUser)(null),e.next=15,w({type:"account/save",payload:{loginUser:u,username:g,renterId:m,deptId:x,realName:y,sysList:o,message:r,id:v,pswd:S,email:I,phone:L}});case 15:return(0,f.resetGoLogin)(),e.next=18,w({type:"save",payload:{loginStatus:i.LOGIN_SUCCESS,loginText:"\u767b\u5f55"}});case 18:e.next=24;break;case 20:if(!n||600!==n.status){e.next=22;break}return e.abrupt("return",!1);case 22:return e.next=24,w({type:"save",payload:{loginStatus:i.LOGIN_FAILED,message:r,loginText:"\u767b\u5f55"}});case 24:case"end":return e.stop()}},e,this)}),getCaptcha:c.default.mark(function e(t,a){var s,n,r=a.put;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(0,o.default)(t),e.next=3,(0,p.getCaptchaImg)();case 3:return s=e.sent,n=s.data,e.next=7,r({type:"save",payload:{captchaImg:n?n.imgData:""}});case 7:case"end":return e.stop()}},e,this)})},reducers:{resetStatus:function(e){return(0,r.default)({},e,{loginStatus:i.LOGIN_SUSPEND})},save:function(e,t){return(0,r.default)({},e,t.payload)}}},e.exports=t.default}});